---
title: 'Webhook Integration Guide'
---

## 1. Webhook Subscription

Partners can subscribe to event notifications from **AccessRC** via the `api/Event/Subscribe` endpoint.

### 💡 Example Requests

#### 🔹 No Authentication
```json
{
  "eventType": "DELIVERY_CHANNEL_STATUS",
  "callbackUrl": "https://partner.example.com/webhook"
}
```
#### 🔹 API Key Authentication
```json
{
  "eventType": "DELIVERY_CHANNEL_STATUS",
  "callbackUrl": "https://partner.example.com/webhook",
  "auth": {
    "type": "header",
    "headerName": "X-API-Key",
    "headerValue": "my-api-key"
  }
}
```
#### 🔹 Basic Authentication
```json
{
  "eventType": "DELIVERY_CHANNEL_STATUS",
  "callbackUrl": "https://partner.example.com/webhook",
  "auth": {
    "type": "basic",
    "username": "webhook-user",
    "password": "s3cr3t"
  }
}
```
#### 🔹 HMAC Authentication
```json
{
  "eventType": "DELIVERY_CHANNEL_STATUS",
  "callbackUrl": "https://partner.example.com/webhook",
  "auth": {
    "type": "hmac",
    "secret": "abcd1234"
  }
}
```

## 2. 🔐 Webhook Request Authentication

AccessRC will send event callbacks to your registered callbackUrl.

Each webhook request will include an authentication header according to your chosen subscription option:

<div className="overflow-x-auto mt-4 mb-4">

| 🔸 Auth Type | 🔖 Header | 🧩 Example |
|--------------|------------|------------|
| **None** | *(no header)* | – |
| **API Key** | `X-API-Key` | `X-API-Key: my-api-key` |
| **Basic** | `Authorization` | `Authorization: Basic bXl1c2VyOm15cGFzc3dvcmQ=` |
| **HMAC** | `X-Signature` | `X-Signature: sha256=abcdef123456...` |

</div>

## 3. 🧮 Verifying HMAC Signatures

When using **HMAC authentication**, every webhook request includes an `X-Signature` header:

```http
x-accessrc-signature: sha256=3bdc5b07d7ef9b61b98ed5df4b1793e12fd...
```

This signature is generated using:

- 🧾 The **raw HTTP request body** (exact bytes, not parsed JSON)  
- 🔑 The **shared secret** you provided in your subscription  

---

### ✅ Verification Steps

1. **Extract the Signature**  
   Read the `X-Signature` header from the incoming request.

2. **Get the Raw Request Body**  
   Use the exact raw payload as received — do not reformat or parse.

3. **Recompute the Signature**  
   Use `HMAC-SHA256(secret, rawBody)` to generate your own hash.  
   Prefix it with `"sha256="`.

4. **Compare Signatures**  
   Compare your computed signature with the received one using a **constant-time comparison**  
   to avoid timing attacks.

---

### 💻 Example (Node.js)

```js
import crypto from "crypto";

function verifyWebhookSignature(req, secret) {
  const received = req.headers["x-signature"]; // e.g. sha256=abcdef...
  const body = req.rawBody; // must be unparsed string or buffer

  const computed = "sha256=" + crypto.createHmac("sha256", secret)
    .update(body)
    .digest("hex");

  return crypto.timingSafeEqual(
    Buffer.from(received),
    Buffer.from(computed)
  );
}
```

## 4. 🔒 Security Best Practices

- 🚫 **Never log or expose the shared secret.**  
- ✅ **Always verify signatures** for HMAC webhooks.  
- 🔍 **Reject any unsigned or invalid webhook requests.**  
- 🌐 **Always use HTTPS** for your webhook endpoint.  
- 🧱 Keep your secret in secure configuration storage (not in code or client apps).  

---

## 5. 🧪 Testing Webhooks

To test locally and ensure your webhook integration works as expected:

1. 🌍 Use a tool like **ngrok** or **localtunnel** to expose your local webhook endpoint publicly.  
2. 🪵 Log incoming request **headers** and the **raw body** for debugging.  
3. 🔑 Simulate signature generation manually using your shared secret to validate your implementation.  
4. 🧩 Verify your signature verification logic before deploying to production.  
5. 🔁 Test retry scenarios by sending multiple requests and validating idempotency.  

> 💡 **Tip:** When testing, return different HTTP status codes (200, 401, 403) to confirm AccessRC handles each scenario as expected.

---

## 6. 📬 Response Expectations

Your webhook endpoint should behave as follows:

- ✅ **Return `HTTP 2xx`** (usually `200 OK`) when processing succeeds.  
- 🔐 **Return `401 Unauthorized`** or **`403 Forbidden`** if signature or authentication validation fails.  
- ⏱️ **Respond quickly** (within a few seconds) — delayed responses may trigger retries.  
- 🧾 Include a short, plain-text or JSON response body if helpful for debugging, but it’s optional.  

### 💬 Example Responses

#### ✅ Success
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "status": "received",
  "message": "Webhook processed successfully"
}
```

#### ❌ Invalid Signature
```http
HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
  "error": "Invalid signature",
  "message": "HMAC verification failed"
}
```

#### 🚫 Forbidden
```http
HTTP/1.1 403 Forbidden
Content-Type: application/json

{
  "error": "Forbidden",
  "message": "Authentication not allowed for this endpoint"
}
```